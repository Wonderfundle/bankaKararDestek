<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Bigabank - Giriş</title>
    <link href="css/styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/js/adminlte.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/css/jquery.dataTables.min.css"  />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  
  </head>
  
  <body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-warning bg-success">
      <!-- Navbar Brand-->
      <a class="navbar-brand ps-3" href="index.html">GİGABANK</a>
      <!-- Sidebar Toggle-->
      <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!">
        <i class="fas fa-bars"></i>
      </button>
      <!-- Navbar Search-->
      <div class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0"></div>
      <!-- Navbar-->
  
      <!-- Navbar-->
      <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown"
            aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
            <!--  <li><a class="dropdown-item" href="#!">Settings</a></li>-->
            <!-- <li><a class="dropdown-item" href="#!">Activity Log</a></li>-->
            <li class="dropdown-header">
              Sistem Yöneticisi
            </li>
            <li><a class="dropdown-item" id="cikisYap">Çıkış Yap</a></li>
          </ul>
        </li>
      </ul>
    </nav>
    <div id="layoutSidenav">
      <div id="layoutSidenav_nav">
        <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
          <div class="sb-sidenav-menu">
            <div class="nav">
              <a class="nav-link" href="index.php">
                <div class="sb-nav-link-icon">
                  <i class="fas fa-tachometer-alt" style="color:blue"></i>
                </div>
                Gösterge Paneli
              </a>
              <a class="nav-link" href="subeHacmi.html">
                <div class="sb-nav-link-icon">
                  <i class="fas fa-dolly"></i>
                </div>
                Şubenin İşlem Hacmi
              </a>
              <div class="collapse" id="collapsePages" aria-labelledby="headingTwo" data-bs-parent="#sidenavAccordion">
            <!--    <nav class="sb-sidenav-menu-nested nav accordion" id="sidenavAccordionPages">
                  <a class="nav-link" href="depo1.php">
                    <div class="sb-nav-link-icon"><i class="fa fa-align-left"></i></div>
                    Depo 1
                  </a>
                  <a class="nav-link" href="depo2.php">
                    <div class="sb-nav-link-icon"><i class="fa fa-align-left"></i></div>
                    Depo 2
                  </a>
                  <a class="nav-link" href="depo3.php">
                    <div class="sb-nav-link-icon"><i class="fa fa-align-left"></i></div>
                    Depo 3
                  </a>
  
                </nav>-->
              </div>
              <div class="sb-sidenav-menu-heading">Müşteri İşlemleri</div>
              <a class="nav-link" href="musteriFaizHesapla.html">
                <div class="sb-nav-link-icon">
                  <i class="fa fa-pen"></i>
                </div>
                Müşteri Faiz Oranı Hesapla
              </a>
              <a class="nav-link" href="musteriAltinGeliriHesapla.html">
                <div class="sb-nav-link-icon">
                  <i class="fa fa-boxes-packing"></i>
                </div>
               Müşteri Altın Geliri Hesapla
              </a>        
              <div class="sb-sidenav-menu-heading">Çalışan İşlemleri</div>
              <a class="nav-link" href="urunListele.php">
                <div class="sb-nav-link-icon">
                  <i class="fa fa-align-left"></i>
                </div>
                Çalışan Verimlilik Hesapla
              </a>
              <a class="nav-link" href="tedarikciListele.php">
                <div class="sb-nav-link-icon">
                  <i class="fa fa-truck-field"></i>
                </div>
                Çalışan Prim Hesapla
              </a>
             
            </div>
          </div>
        </nav>
      </div>
      <div id="layoutSidenav_content">
        <main>
            <main>
                <div class="container">
                  <section class="content">
                    <div class="card">
                      <div class="card-header">
                        <h3 class="card-title">Çalışan Verimliliği Hesaplamas</h3>
                      </div>
        
                      <div class="card-body">
                        <div class="row">
                          <div class="col">
                            <div class="form-group row">
                              <label>Çalışan Adı</label>
                              <div class="col-sm-10">
                                <select class="form-control" id="calisanSec" required>
    <option value="" disabled selected>Çalışan Seçin</option>
                                </select>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col">
                            <div class="form-group row">
                              <label>Çalışan Unvanı</label>
                              <div class="col-sm-10">
                                <input type="text" placeholder="Unvan ID" class="form-control" id="unvanID">
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col">
                              <div class="form-group row">
                                <label>Süre</label>
                                <div class="col-sm-10">
                                  <input type="text" placeholder="Süre" class="form-control" id="sure">
                                </div>
                              </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                  <div class="form-group row">
                                    <label>Maaşı</label>
                                    <div class="col-sm-10">
                                      <input type="text" placeholder="Maaşı" class="form-control" id="maas">
                                    </div>
                                  </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                      <div class="form-group row">
                                        <label>Hedefe Ulaşma Yüzdesi</label>
                                        <div class="col-sm-10">
                                          <input type="text" placeholder="Hedefe Ulaşma Yüzdesi" class="form-control" id="hedefYuzde">
                                        </div>
                                      </div>
                                    </div>
                      </div>
                      <button type="button" id="calculateBtn" class="btn btn-primary mx-auto col-3 my-1">
                        Verimlilik Hesapla
                      </button>
                      <canvas id="myChart" width="400" height="200"></canvas>
                    </main>
    </div>
    </div>
    
    <script>
      // Tüm fetch işlemlerini birleştirip ardından sayfa içinde gerekli yerlere verileri yerleştirme
      async function fetchDataAndPopulate() {
          try {
              // Çalışanları getir
              const calisanlarResponse = await fetch('http://localhost:3000/api/calisanlar');
              const calisanlarData = await calisanlarResponse.json();

              // Çalışanları dropdown'a ekle
              const calisanSec = document.getElementById('calisanSec');
              calisanlarData.forEach(calisan => {
                  const option = document.createElement('option');
                  option.value = calisan.id;
                  option.text = calisan.adSoyad;
                  calisanSec.appendChild(option);
              });

              // Diğer fetch işlemlerini buraya ekleyebilirsin
          } catch (error) {
              console.error(error);
          }
      }

      // Sayfa yüklendiğinde çalışacak fonksiyon
      window.onload = function () {
          fetchDataAndPopulate();
      };

      // Diğer JavaScript kodları buraya gelecek
  </script>
 <script>
  document.getElementById('calisanSec').addEventListener('change', function() {
      const selectedWorkerID = this.value;
      console.log(selectedWorkerID)
      fetch(`http://localhost:3000/api/calisan/${selectedWorkerID}`)
          .then(response => response.json())
          .then(selectedCalisan => {
              const unvanIDInput = document.getElementById('unvanID');
              const sureInput = document.getElementById('sure');
              const maasInput = document.getElementById('maas');
              const hedefYuzdeInput = document.getElementById('hedefYuzde');

              unvanIDInput.value = selectedCalisan.unvanID || ''; // Eğer değer yoksa boş bırak
              sureInput.value = selectedCalisan.sure || '';
              maasInput.value = selectedCalisan.maas || '';
              hedefYuzdeInput.value = selectedCalisan.hedefYuzde || '';
          })
          .catch(error => console.error(error));
  });
</script>
    <script>
      document.getElementById("cikisYap").addEventListener("click", function() {
          window.location.href = "login.html"; // Sayfa yönlendirme işlemi
      });
      </script>
       <script>
        document.addEventListener('DOMContentLoaded', function() {
    // Çalışanlar için veri alındığında bu fonksiyon çalışacak
    function populateCalisanOptions(calisanlar) {
      const calisanSec = document.getElementById('calisanSec');
      calisanlar.forEach(calisan => {
        const option = document.createElement('option');
        option.value = calisan.id;
        option.text = calisan.adSoyad;
        calisanSec.appendChild(option);
      });
    }
  
    // Çalışan verilerini almak için API'yi çağıran fonksiyon
    function fetchCalisanlar() {
      fetch('http://localhost:3000/calisanlar')
        .then(response => response.json())
        .then(calisanlar => {
          populateCalisanOptions(calisanlar);
        })
        .catch(error => console.error(error));
    }
  
    // Çalışan verilerini sayfa yüklendiğinde al
    fetchCalisanlar();
  
    // Hesapla butonuna tıklandığında çalışacak fonksiyon
    document.getElementById('calculateBtn').addEventListener('click', function() {
    updateAndCalculate();
});

// Form verilerini güncelleyip puanları hesaplayan fonksiyon
function updateAndCalculate() {
    const selectedWorkerID = document.getElementById('calisanSec').value;

    // Seçilen çalışanın verilerini almak için API'yi çağır
    fetch(`http://localhost:3000/api/calisan/${selectedWorkerID}`)
        .then(response => response.json())
        .then(selectedCalisan => {
            // Alınan çalışan bilgileri ile verimlilik puanını hesapla
            const unvanID = selectedCalisan.unvanID;
            const sure = selectedCalisan.sure;
            const maas = selectedCalisan.maas;
            const hedefYuzde = selectedCalisan.hedefYuzde;

            // Puanlama kurallarına göre puanları hesapla
            const unvanPuan = getUnvanPuan(unvanID);
            const surePuan = getSurePuan(sure);
            const maasPuan = getMaasPuan(maas);
            const hedefYuzdePuan = getHedefYuzdePuan(hedefYuzde);

            // Toplam puanı hesapla
            const toplamPuan = unvanPuan + surePuan + maasPuan + hedefYuzdePuan;

            // Toplam puanı gösteren fonksiyonu çağır
            function result(toplamPuan) {
    // Your logic for handling toplamPuan
    console.log("Toplam Puan:", toplamPuan);
}


            // Verimliliği belirle ve grafiği oluştur
            const verimlilik = getVerimlilik(toplamPuan);
            createChart(verimlilik);
        })
        .catch(error => console.error(error));
}

    // Unvan ID'ye göre puanı döndüren fonksiyon
    function getUnvanPuan(unvanID) {
      // Puanlama kurallarını burada tanımla
      if (unvanID === 1) {
        return 1;
      } else if (unvanID === 2) {
        return 2;
      } else if (unvanID === 3) {
        return 3;
      } else if (unvanID === 4) {
        return 4;
      } else {
        return 0;
      }
    }
  
    // Süre değerine göre puanı döndüren fonksiyon
    function getSurePuan(sure) {
      // Puanlama kurallarını burada tanımla
      if (sure < 365) {
        return 1;
      } else if (sure <= 730) {
        return 2;
      } else {
        return 3;
      }
    }
  
    // Maaş değerine göre puanı döndüren fonksiyon
    function getMaasPuan(maas) {
      // Puanlama kurallarını burada tanımla
      if (maas < 15000) {
        return 1;
      } else if (maas <= 25000) {
        return 2;
      } else {
        return 3;
      }
    }
  
    // Hedef Yüzdesi değerine göre puanı döndüren fonksiyon
    function getHedefYuzdePuan(hedefYuzde) {
      // Puanlama kurallarını burada tanımla
      if (hedefYuzde < 60) {
        return 0;
      } else if (hedefYuzde <= 70) {
        return 1;
      } else if (hedefYuzde <= 85) {
        return 2;
      } else {
        return 3;
      }
    }
  
    // Toplam puanı baz alarak verimliliği belirleyen fonksiyon
    function getVerimlilik(toplamPuan) {

      // Verimlilik kriterlerini burada tanımla
      if (toplamPuan > 7) {
        return 'Verimli';
      } else if (toplamPuan >= 5) {
        return 'Orta Verimli';
      } else {
        return 'Verimsiz';
      }
    }

    console.log(verimlilik)
    // Verimlilik durumuna göre grafiği oluşturan fonksiyon
    function createChart(verimlilik) {
      const ctx = document.getElementById('myChart').getContext('2d');
      const myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Verimlilik'],
          datasets: [{
            label: 'Çalışan Verimliliği',
            data: [verimlilik === 'Verimli' ? 3 : (verimlilik === 'Orta Verimli' ? 2 : 1)],
            backgroundColor: [
              'rgba(75, 192, 192, 0.2)',
            ],
            borderColor: [
              'rgba(75, 192, 192, 1)',
            ],
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true,
              max: 3
            }
          }
        }
      });
    }
  });
       </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js"
      crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
  </body>
  
  </html>